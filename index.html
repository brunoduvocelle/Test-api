

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Gestion des Contacts API</title>
    <style>
        :root { --primary: #3498db; --success: #27ae60; --dark: #2c3e50; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; color: var(--dark); }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 600px; margin: auto; }
        
        /* Formulaire */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px; color: white; transition: opacity 0.2s; }
        #addBtn { background: var(--success); }
        #loadBtn { background: var(--primary); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Tableau */
        table { width: 100%; border-collapse: collapse; margin-top: 30px; }
        th { background: var(--dark); color: white; text-align: left; padding: 12px; }
        td { padding: 12px; border-bottom: 1px solid #ddd; }
        .loading { text-align: center; font-style: italic; color: #7f8c8d; }
    </style>
</head>
<body>

<div class="container">
    <h1>üìù Ajouter un Contact</h1>
    
    <form id="contactForm">
        <div class="form-group">
            <label>Nom</label>
            <input type="text" id="nom" required>
        </div>
        <div class="form-group">
            <label>Pr√©nom</label>
            <input type="text" id="prenom" required>
        </div>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="mail" required>
        </div>
        <div class="btn-group">
            <button type="submit" id="addBtn">Enregistrer</button>
            <button type="button" id="loadBtn">Actualiser la liste</button>
        </div>
    </form>

    <div id="status" style="margin-top: 15px; text-align: center; font-weight: bold;"></div>

    <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
    
    <div id="display">
        <p class="loading">Cliquez sur "Actualiser" pour voir la liste.</p>
    </div>
</div>

<script>
{
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwZNCccbYN4tGOIFrdBXdDDM3pqswlH_l38m3XKui4mInj6xuLueEHLOa12zHMoYkr0/exec"; 

    const form = document.getElementById('contactForm');
    const display = document.getElementById('display');
    const status = document.getElementById('status');

    // FONCTION : LIRE (GET)
    const loadData = async () => {
        display.innerHTML = '<p class="loading">Chargement des donn√©es...</p>';
        try {
            const response = await fetch(SCRIPT_URL);
            const data = await response.json();
            
            let html = `<table><tr><th>Nom</th><th>Pr√©nom</th><th>Email</th></tr>`;
            data.forEach(item => {
                html += `<tr><td>${item.nom}</td><td>${item.prenom}</td><td>${item.mail}</td></tr>`;
            });
            display.innerHTML = html + `</table>`;
        } catch (e) {
            display.innerHTML = "Erreur de chargement.";
        }
    };

    // FONCTION : √âCRIRE (POST)
    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const btn = document.getElementById('addBtn');
        btn.disabled = true;
        status.innerText = "‚è≥ Envoi en cours...";
        status.style.color = "orange";

        const formData = {
            nom: document.getElementById('nom').value,
            prenom: document.getElementById('prenom').value,
            mail: document.getElementById('mail').value
        };

        try {
            await fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // Important pour Google Script
                cache: 'no-cache',
                body: JSON.stringify(formData)
            });

            status.innerText = "‚úÖ Ajout√© avec succ√®s !";
            status.style.color = "green";
            form.reset();
            setTimeout(() => { status.innerText = ""; loadData(); }, 2000);
        } catch (error) {
            status.innerText = "‚ùå Erreur d'envoi.";
            status.style.color = "red";
        } finally {
            btn.disabled = false;
        }
    });

    document.getElementById('loadBtn').addEventListener('click', loadData);
}
</script>
</body>
</html>

